{{#section 'header'}}
    <link href="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.2.5/css/fileinput.min.css" media="all" rel="stylesheet" type="text/css" />
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.5.0/font/bootstrap-icons.min.css" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.css" integrity="sha512-bYPO5jmStZ9WI2602V2zaivdAnbAhtfzmxnEGh9RwtlI00I9s8ulGe4oBa5XxiC6tCITJH/QG70jswBhbLkxPw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
{{/section}}


{{#if mess}}
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        <strong>{{mess}}!</strong>
        <button type="button" class="btn-close" data-bs-dismiss="alert" aria-label="Close"></button>
    </div>
{{/if}}

<div class="container-fluid">
    <form enctype="multipart/form-data" method="post" id="formProduct">
        <div class="row mt-4">
            <div class="col-sm-4">
                <div class="card">
                    <div class="card-header text-white bg-secondary">
                        Thông tin sản phẩm
                    </div>
                    <div class="card-body">
                        <div class="mb-3">
                            <label for="ProName" class="form-label">Tên sản phẩm</label>
                            <input type="text" class="form-control" id="ProName" name="ProName" required>
                        </div>
                        <div class="my-3">
                            <label for="cars" class="form-label">Loại sản phẩm:</label>
                            <select id="cars" name="CatDeID" class="form-control">
                                {{#each cateDetail}}
                                <option value="{{this.CatDeID}}">{{this.CatDeName}}</option>
                                {{/each}}
                            </select>
                        </div>

                        <div class="my-3">
                            <label for="TinyDes" class="form-label">Mô tả khát quát</label>
                            <input type="text" class="form-control" id="TinyDes" name="TinyDes" required>
                        </div>

                        <div class="my-3">
                            <label for="CurPrice" class="form-label">Giá khởi động</label>
                            <input type="number" class="form-control" id="CurPrice" name="CurPrice" required>
                        </div>

                        <div class="my-3">
                            <label for="BuyNowPrice" class="form-label">Giá mua ngay</label>
                            <input type="number" class="form-control" id="BuyNowPrice" name="BuyNowPrice" required>
                        </div>

                        <div class="my-3">
                            <label for="StepPrice" class="form-label">Bước giá tối thiểu</label>
                            <input type="number" class="form-control" id="StepPrice" name="StepPrice" required>
                        </div>


                        <div class="my-3">
                            <label for="cars" class="form-label">Trạng thái sản phẩm:</label>
                            <select id="cars" name="AutoExtend" class="form-control">
                                <option value="1">Tự động gia hạn</option>
                                <option value="0">Không tự động gia hạn</option>
                            </select>
                        </div>

                        <div class="my-3">
                            <label for="EndDate" class="form-label">Ngày giờ kết thúc</label>
                            <input type="text" class="form-control" id="EndDate" name="EndDate" required>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="col-sm-8">
                <div class="card">
                    <div class="card-header text-white bg-secondary">
                        Thông tin chi tiết
                    </div>
                    <div class="card-body">
                        <label for="thumbImg" class="mb-3"><b>Hình ảnh đại diện</b></label>
                        <div class="file-loading">
                            <input id="thumbImg" name="thumbImg" type="file" required>
                        </div>

                        <label for="detailImg" class="my-3"><b>Hình ảnh chi tiết</b></label>
                        <div class="file-loading">
                            <input id="detailImg" name="detailImg" type="file" multiple required>
                        </div>

                        <label for="accountImg" class="my-3"><b>Hình ảnh khái quát</b></label>
                        <div class="file-loading">
                            <input id="accountImg" name="accountImg" type="file" required>
                        </div>
                        <div class="my-3">
                            <label for="FullDes" class="form-label mb-3"><b>Mô tả chi tiết</b></label>
                            <textarea id="FullDes" name="FullDes"></textarea>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div class="mt-3 mb-3">
            <input type="submit" class="form-control btn btn-success" value="Đăng bán">
        </div>
    </form>
</div>


{{#section 'footer'}}
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-datetimepicker/2.5.20/jquery.datetimepicker.full.min.js" integrity="sha512-AIOTidJAcHBH2G/oZv9viEGXRqDNmfdPVPYOYKGy3fti0xIplnlgMHUGfuNRzC6FkzIo0iIxgFnr9RikFxK+sw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script src="https://cdn.tiny.cloud/1/no-api-key/tinymce/5/tinymce.min.js" referrerpolicy="origin"></script>
    <script src="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.2.5/js/fileinput.min.js"></script>
    <script src="https://cdn.jsdelivr.net/gh/kartik-v/bootstrap-fileinput@5.2.5/themes/fas/theme.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.1.1/dist/js/bootstrap.bundle.min.js" crossorigin="anonymous"></script>

    <script>
        $(document).ready(function() {
            $("#thumbImg").fileinput({
                initialPreviewAsData: true,
                deleteUrl: "/site/file-delete",
                overwriteInitial: false,
                maxFileSize: 200,
                allowedFileExtensions: ['jpg', 'png', 'gif'],
            });
        });
        $(document).ready(function() {
            $("#accountImg").fileinput({
                initialPreviewAsData: true,
                deleteUrl: "/site/file-delete",
                overwriteInitial: false,
                maxFileSize: 200,
                allowedFileExtensions: ['jpg', 'png', 'gif'],
            });
        });
        $(document).ready(function() {
            $("#detailImg").fileinput({
                initialPreviewAsData: true,
                deleteUrl: "/site/file-delete",
                overwriteInitial: false,
                maxFileSize: 200,
                maxFileCount: 3,
                allowedFileExtensions: ['jpg', 'png', 'gif'],
            });
        });
    </script>

    <script>
        tinymce.init({
            selector: '#FullDes',
            plugins: 'paste image link autolink lists table media',
            menubar: false,
            toolbar: [
                'undo redo | bold italic underline strikethrough | numlist bullist | alignleft aligncenter alignright | forecolor backcolor | table link ',
            ],
        });
    </script>
    <script>
        $('#EndDate').datetimepicker({
            format: "Y-m-d H:i:s",
            minDate: '+1970/01/02'
        });

        $('#formProduct').on('submit', function (e){
            e.preventDefault();
            const CurPrice = $('#CurPrice').val();
            const PrompPrice = $('#BuyNowPrice').val();
            const StepPrice = $('#StepPrice').val();
            if(CurPrice>PrompPrice){
                alert('Giá mua ngay nhỏ hơn giá khởi đầu');
                console.log(CurPrice)
                return;
            }
            if(StepPrice > (PrompPrice-CurPrice)){
                alert('Bước giá quá lớn');
                return;
            }
            $('#formProduct').off('submit').submit();
        })
    </script>
{{/section}}